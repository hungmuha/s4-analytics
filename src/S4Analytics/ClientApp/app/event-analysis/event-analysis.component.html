<section class="event-analysis-grid">
    <div class="filters">filters</div>
    <div class="filter-controls">filter controls</div>
    <div class="scope">
        Date/Time
        <a href="javascript:void(0)" (click)="openDateTimeModal(dateTimeScope)">
            <span class="badge badge-secondary">
                {{dateTimeLabel}}
                <span class="fa fa-caret-down"></span>
            </span>
        </a>
        Place
        <a href="javascript:void(0)" (click)="openPlaceModal(placeScope)">
            <span class="badge badge-secondary">
                {{placeLabel}}
                <span class="fa fa-caret-down"></span>
            </span>
        </a>
    </div>
    <div class="map-controls">
        Total: {{totalCount}} / Mapped: {{mappedCount}} / Unmapped: {{unmappedCount}}
    </div>
    <div class="map" id="mapArea">
        <event-map mapId="eventMap"></event-map>
    </div>
    <kendo-grid [class]="['attributes']"
                [data]="state.crashGridData"
                [pageSize]="state.gridPageSize"
                [scrollable]="'virtual'"
                [skip]="state.crashGridSkip"
                [pageable]="true"
                [rowHeight]="35"
                (pageChange)="pageChange($event)">
        <kendo-grid-column field="id" title="Id"></kendo-grid-column>
        <kendo-grid-column field="hsmvReportNumber" title="Report Number"></kendo-grid-column>
        <kendo-grid-column field="crashDate" title="Date"></kendo-grid-column>
        <kendo-grid-column field="crashTime" title="Time"></kendo-grid-column>
        <kendo-grid-column field="agncyNm" title="Agency Name"></kendo-grid-column>
    </kendo-grid>
    <div class="attribute-controls">attribute controls</div>
</section>

<ng-template #dateTimeScope let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Date/Time</h4>
        <button type="button" class="close" aria-label="Close" (click)="d()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-6">
                <div class="row">
                    <div class="col-12 mb-1">
                        From date
                    </div>
                    <div class="col-12">
                        <kendo-datepicker [(value)]="_startDate"></kendo-datepicker>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="row">
                    <div class="col-12 mb-1">
                        To date
                    </div>
                    <div class="col-12">
                        <kendo-datepicker [(value)]="_endDate"></kendo-datepicker>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-dark" (click)="c()">Apply</button>
    </div>
</ng-template>

<ng-template #placeScope let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Place</h4>
        <button type="button" class="close" aria-label="Close" (click)="d()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-12 mb-1">
                Geographic extent
            </div>
            <div class="col-12 geo-extent-btn-group">
                <button-group [multipleSelect]="false"
                              [items]="['Statewide','County','City']"
                              [(ngModel)]="_geoExtent"></button-group>
            </div>
        </div>
        <ng-container *ngIf="_geoExtent==='County'">
            <div class="row">
                <div class="col-12 mb-1">
                    County
                </div>
                <div class="col-12">
                    <kendo-multiselect [filterable]="true"
                                       [data]="_filteredCounties"
                                       textField="name"
                                       valueField="key"
                                       placeholder="Search counties"
                                       (filterChange)="filterCounties($event)"
                                       [(ngModel)]="_selectedCounties"></kendo-multiselect>
                </div>
            </div>
        </ng-container>
        <ng-container *ngIf="_geoExtent==='City'">
            <div class="row">
                <div class="col-12 mb-1">
                    City
                </div>
                <div class="col-12">
                    <kendo-multiselect [filterable]="true"
                                       [data]="_filteredCities"
                                       textField="name"
                                       valueField="key"
                                       placeholder="Search cities"
                                       (filterChange)="filterCities($event)"
                                       [(ngModel)]="_selectedCities"></kendo-multiselect>
                </div>
            </div>
        </ng-container>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-dark" (click)="c()">Apply</button>
    </div>
</ng-template>
